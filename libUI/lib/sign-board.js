(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("vue")):"function"===typeof define&&define.amd?define(["vue"],t):"object"===typeof exports?exports["cqc"]=t(require("vue")):(e["cqc"]=e["cqc"]||{},e["cqc"]["sign-board"]=t(e["vue"]))})(self,(function(e){return function(){"use strict";var t={441:function(t){t.exports=e}},n={};function o(e){var i=n[e];if(void 0!==i)return i.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,o),r.exports}!function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}();var i={};return function(){o.d(i,{default:function(){return u}});var e=o(441),t={width:{type:String,default:"100vw"},height:{type:String,default:"100vh"},lineWidth:{type:Number,default:2},strokeStyle:{type:String,default:"#000"},lineCap:{type:String,default:"round"},lineDash:{type:Array,default:()=>[0,0]},doubleLine:{type:Boolean,default:!1},previewBtn:{type:Boolean,default:!0},miniType:{type:String,default:"image/png"},canvasBg:{type:[String,Boolean],default:!1}};function n(t,n,o,i){let r,u,a,c,l=!1;const{lineWidth:s,strokeStyle:d,lineCap:f,lineDash:p,doubleLine:v,miniType:h,canvasBg:g}=t;function y(e){g&&(e.fillStyle=g,e.fillRect(0,0,o.value,i.value)),e.lineWidth=s,e.strokeStyle=d,e.lineCap=f,(p[0]>0||p[1]>0)&&e.setLineDash(p)}function m(e,t,n){e.lineTo(t,n),e.stroke()}function b(e,t,n){v&&e.save(),e.beginPath(),e.moveTo(t,n)}function x(e){l=!1,v&&(e.globalCompositeOperation="destination-out",e.lineWidth=parseInt(s/3),e.stroke(),e.restore())}function w(){c.clearRect(0,0,o.value,i.value)}function S(){n.value.toDataURL(h)}function q(){return n.value.toDataURL(h)}const B=e=>{l=!0,r=a.getBoundingClientRect().left,u=a.getBoundingClientRect().top;let t=e.touches?e.touches[0].clientX:e.clientX,n=e.touches?e.touches[0].clientY:e.clientY;b(c,t-r,n-u)},k=e=>{if(!l)return;let t=e.touches?e.touches[0].clientX:e.clientX,n=e.touches?e.touches[0].clientY:e.clientY;m(c,t-r,n-u)},L=()=>{x(c)},N={touchstart:B,touchmove:k,touchend:L,mousedown:B,mousemove:k,mouseup:L};function T(){a=n.value,c=a.getContext("2d"),y(c),Object.entries(N).forEach((([e,t])=>{a.addEventListener(e,t)})),window.addEventListener("mouseup",L)}return(0,e.onBeforeUnmount)((()=>{Object.entries(N).forEach((([e,t])=>{a.removeEventListener(e,t)})),window.removeEventListener("mouseup",L)})),(0,e.onMounted)((()=>{(0,e.nextTick)((()=>{setTimeout((()=>{T()}),200)}))})),{clear:w,preview:S,getData:q}}var r={name:"CqcSignBoard",props:t,setup(t,{emit:o}){const i=(0,e.ref)(null);let r=(0,e.ref)(0),u=(0,e.ref)(0),a=(0,e.ref)(null),c=(0,e.ref)(null);const{clear:l,getData:s}=n(t,i,r,u),d=()=>{o("getData",s())},f=(0,e.reactive)({width:t.width,height:t.height});return(0,e.onMounted)((()=>{(0,e.nextTick)((()=>{r.value=a.value.clientWidth-20,u.value=a.value.clientHeight-c.value.offsetHeight-20}))})),()=>(0,e.createVNode)("div",{class:"cqc-sign-board",style:f,ref:a},[(0,e.createVNode)("canvas",{ref:i,width:r.value,height:u.value,class:"cqc-sign-board-canvas"},null),(0,e.createVNode)("div",{class:"cqc-sign-board-control",ref:c},[(0,e.createVNode)("button",{onclick:l},[(0,e.createTextVNode)("清空")]),(0,e.createVNode)("span",{style:"padding:4px"},null),(0,e.createVNode)("button",{class:"primary",onclick:d},[(0,e.createTextVNode)("确定")])])])},install:e=>e.component(r.name,r)},u=r}(),i=i["default"],i}()}));