(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e(require("vue")):"function"===typeof define&&define.amd?define(["vue"],e):"object"===typeof exports?exports["cqc"]=e(require("vue")):(t["cqc"]=t["cqc"]||{},t["cqc"]["load-more"]=e(t["vue"]))})(self,(function(t){return function(){"use strict";var e={3744:function(t,e){e.Z=(t,e)=>{const o=t.__vccOpts||t;for(const[n,r]of e)o[n]=r;return o}},441:function(e){e.exports=t}},o={};function n(t){var r=o[t];if(void 0!==r)return r.exports;var c=o[t]={exports:{}};return e[t](c,c.exports,n),c.exports}!function(){n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}();var r={};return function(){n.d(r,{default:function(){return h}});var t=n(441);const e={class:"cqc-load-more",ref:"loadMore"},o={key:0,class:"cqc-load-more-top"},c={class:"cqc-icon cqc-icon-loading"},a={key:1,class:"cqc-load-more-bottom"},l={key:0,class:"cqc-icon cqc-icon-loading"};function p(n,r,p,s,u,i){return(0,t.openBlock)(),(0,t.createElementBlock)("div",e,[(0,t.createElementVNode)("div",{class:(0,t.normalizeClass)(["cqc-load-more-content",{isdropped:n.topDropped||n.bottomDropped}]),style:(0,t.normalizeStyle)({transform:s.transform})},[p.topMethod?((0,t.openBlock)(),(0,t.createElementBlock)("div",o,[(0,t.withDirectives)((0,t.createElementVNode)("span",{class:"cqc-load-more-text"},(0,t.toDisplayString)(s.topText),513),[[t.vShow,"loading"!==n.topStatus]]),(0,t.withDirectives)((0,t.createElementVNode)("i",c,null,512),[[t.vShow,"loading"===n.topStatus]])])):(0,t.createCommentVNode)("",!0),(0,t.renderSlot)(n.$slots,"default"),p.bottomMethod?((0,t.openBlock)(),(0,t.createElementBlock)("div",a,[n.bottomDropped?((0,t.openBlock)(),(0,t.createElementBlock)("i",l)):(0,t.createCommentVNode)("",!0)])):(0,t.createCommentVNode)("",!0)],6)],512)}function s(t){let e=t;while(e&&"HTML"!==e.tagName&&"BODY"!==e.tagName&&1===e.nodeType){let t=window.getComputedStyle(e).overflowY;if("auto"===t||"scroll"===t)return e;e=e.parentNode}return window}function u(t){return t===window?Math.max(window.pageYOffset||0,document.documentElement.scrollTop):t.scrollTop}function i(t,e=50){let o=null;return function(...n){if(null===o)return t.apply(this,n),void(o=0);o||(o=setTimeout((()=>{t.apply(this,n),o=0}),e))}}var d={name:"CqcLoadMore",props:{topMethod:Function,bottomMethod:Function,finished:{type:Boolean,default:!1},bottomDistance:{type:Number,default:100}},setup(e){const o=(0,t.ref)(null),n=.5;let r;const c=50;let a=0,l=!1;const p=(0,t.reactive)({topDropped:!1,bottomDropped:!1,translate:0,topStatus:""});let d,m,f;const v=(0,t.computed)((()=>`translate3d(0, ${p.translate}px, 0)`)),h=(0,t.computed)((()=>{switch(p.topStatus){case"pull":return"下拉刷新";case"drop":return"释放更新";case"loading":return"加载中..."}})),b=()=>{p.translate=0,setTimeout((()=>{p.topStatus="pull",p.topDropped=!1}),200)},g=()=>{p.bottomDropped=!1},w=t=>{l=!0,f=t.touches?t.touches[0].clientY:t.clientY,a=u(m),"loading"!==p.topStatus&&(p.topStatus="pull",p.topDropped=!1),"loading"!==p.bottomStatus&&(p.bottomStatus="pull",p.bottomDropped=!1)},y=t=>{if(!l)return;if(f<d.getBoundingClientRect().top||f>d.getBoundingClientRect().bottom)return;let o=t.touches?t.touches[0].clientY:t.clientY,s=(o-f)*n;r=s>0?"down":"up","function"===typeof e.topMethod&&"down"===r&&0===u(m)&&"loading"!==p.topStatus&&(t.cancelable&&t.preventDefault(),t.stopPropagation(),p.translate=s-a,p.translate<0&&(p.translate=0),p.topStatus=s>c?"drop":"pull")},S=t=>{l=!1,"down"===r&&e.topMethod&&0===u(m)&&p.translate>0&&(p.topDropped=!0,"drop"===p.topStatus?(p.translate=50,p.topStatus="loading",e.topMethod()):(p.topStatus="pull",p.translate=0))},D=i((t=>{e.finished||"function"!==typeof e.bottomMethod||p.bottomDropped||(t.stopPropagation(),m.scrollHeight-u(m)-m.clientHeight<e.bottomDistance&&(p.bottomDropped=!0,e.bottomMethod()))})),q={touchstart:w,touchmove:y,touchend:S,mousedown:w,mousemove:y,mouseup:S},x=()=>{Object.entries(q).forEach((([t,e])=>{d.addEventListener(t,e)})),m.addEventListener("scroll",D)},E=()=>{d=o.value,m=s(d),x()};return(0,t.onMounted)((()=>{(0,t.nextTick)((()=>{E()}))})),(0,t.onBeforeUnmount)((()=>{Object.entries(q).forEach((([t,e])=>{d.removeEventListener(t,e)})),m.removeEventListener("scroll",D),window.removeEventListener("mouseup",S)})),{...(0,t.toRefs)(p),loadMore:o,transform:v,onTopLoaded:b,onBottomLoaded:g,topText:h}}},m=n(3744);const f=(0,m.Z)(d,[["render",p]]);var v=f;v.install=t=>t.component(v.name,v);var h=v}(),r=r["default"],r}()}));