(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e(require("vue")):"function"===typeof define&&define.amd?define(["vue"],e):"object"===typeof exports?exports["cqc"]=e(require("vue")):(t["cqc"]=t["cqc"]||{},t["cqc"]["load-more"]=e(t["vue"]))})(self,(function(t){return function(){"use strict";var e={3744:function(t,e){e.Z=(t,e)=>{const o=t.__vccOpts||t;for(const[n,r]of e)o[n]=r;return o}},441:function(e){e.exports=t}},o={};function n(t){var r=o[t];if(void 0!==r)return r.exports;var a=o[t]={exports:{}};return e[t](a,a.exports,n),a.exports}!function(){n.d=function(t,e){for(var o in e)n.o(e,o)&&!n.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})}}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}();var r={};return function(){n.d(r,{default:function(){return h}});var t=n(441);const e={class:"cqc-load-more",ref:"loadMore"},o={key:0,class:"cqc-load-more-top"},a={class:"cqc-icon cqc-icon-loading"},c={key:1,class:"cqc-load-more-bottom"},l={key:0,class:"cqc-icon cqc-icon-loading"};function p(n,r,p,s,d,i){return(0,t.openBlock)(),(0,t.createElementBlock)("div",e,[(0,t.createElementVNode)("div",{class:(0,t.normalizeClass)(["cqc-load-more-content",{isdropped:n.topDropped||n.bottomDropped}]),style:(0,t.normalizeStyle)({transform:s.transform})},[p.topMethod?((0,t.openBlock)(),(0,t.createElementBlock)("div",o,[(0,t.withDirectives)((0,t.createElementVNode)("span",{class:"cqc-load-more-text"},(0,t.toDisplayString)(s.topText),513),[[t.vShow,"loading"!==n.topStatus]]),(0,t.withDirectives)((0,t.createElementVNode)("i",a,null,512),[[t.vShow,"loading"===n.topStatus]])])):(0,t.createCommentVNode)("",!0),(0,t.renderSlot)(n.$slots,"default"),p.bottomMethod?((0,t.openBlock)(),(0,t.createElementBlock)("div",c,[n.bottomDropped?((0,t.openBlock)(),(0,t.createElementBlock)("i",l)):(0,t.createCommentVNode)("",!0)])):(0,t.createCommentVNode)("",!0)],6)],512)}function s(t){let e=t;while(e&&"HTML"!==e.tagName&&"BODY"!==e.tagName&&1===e.nodeType){let t=window.getComputedStyle(e).overflowY;if("auto"===t||"scroll"===t)return e;e=e.parentNode}return window}function d(t){return t===window?Math.max(window.pageYOffset||0,document.documentElement.scrollTop):t.scrollTop}function i(t,e=50){let o=null;return function(...n){if(null===o)return t.apply(this,n),void(o=0);o||(o=setTimeout((()=>{t.apply(this,n),o=0}),e))}}var u={name:"CqcLoadMore",props:{topMethod:Function,bottomMethod:Function,finished:{type:Boolean,default:!1},bottomDistance:{type:Number,default:100}},setup(e){const o=(0,t.ref)(null),n=.5;let r;const a=50;let c=0;const l=(0,t.reactive)({topDropped:!1,bottomDropped:!1,translate:0,topStatus:""});let p,u,m;const f=(0,t.computed)((()=>`translate3d(0, ${l.translate}px, 0)`)),v=(0,t.computed)((()=>{switch(l.topStatus){case"pull":return"下拉刷新";case"drop":return"释放更新";case"loading":return"加载中..."}})),h=()=>{l.translate=0,setTimeout((()=>{l.topStatus="pull",l.topDropped=!1}),200)},b=()=>{l.bottomDropped=!1},g=t=>{m=t.touches[0].clientY,c=d(u),"loading"!==l.topStatus&&(l.topStatus="pull",l.topDropped=!1),"loading"!==l.bottomStatus&&(l.bottomStatus="pull",l.bottomDropped=!1)},y=t=>{if(m<p.getBoundingClientRect().top||m>p.getBoundingClientRect().bottom)return;let o=(t.touches[0].clientY-m)*n;r=o>0?"down":"up","function"===typeof e.topMethod&&"down"===r&&0===d(u)&&"loading"!==l.topStatus&&(t.cancelable&&t.preventDefault(),t.stopPropagation(),l.translate=o-c,l.translate<0&&(l.translate=0),l.topStatus=o>a?"drop":"pull")},S=t=>{"down"===r&&e.topMethod&&0===d(u)&&l.translate>0&&(l.topDropped=!0,"drop"===l.topStatus?(l.translate=50,l.topStatus="loading",e.topMethod()):(l.topStatus="pull",l.translate=0))},w=i((t=>{e.finished||"function"!==typeof e.bottomMethod||l.bottomDropped||(t.stopPropagation(),u.scrollHeight-d(u)-u.clientHeight<e.bottomDistance&&(l.bottomDropped=!0,e.bottomMethod()))})),D=()=>{p.addEventListener("touchstart",g),p.addEventListener("touchmove",y),p.addEventListener("touchend",S),u.addEventListener("scroll",w)},q=()=>{p=o.value,u=s(p),D()};return(0,t.onMounted)((()=>{(0,t.nextTick)((()=>{q()}))})),(0,t.onBeforeUnmount)((()=>{p.removeEventListener("touchstart",g),p.removeEventListener("touchmove",y),p.removeEventListener("touchend",S),u.removeEventListener("scroll",w)})),{...(0,t.toRefs)(l),loadMore:o,transform:f,onTopLoaded:h,onBottomLoaded:b,topText:v}}},m=n(3744);const f=(0,m.Z)(u,[["render",p]]);var v=f;v.install=t=>t.component(v.name,v);var h=v}(),r=r["default"],r}()}));